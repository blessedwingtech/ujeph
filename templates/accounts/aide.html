{% extends 'base.html' %}

{% block title %}Aide & Manuel d'utilisation - SG-UJEPH{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- En-tête principal -->
    <div class="row mb-4">
        <div class="col">
            <h2 class="mb-3">
                <i class="bi bi-question-circle-fill text-primary"></i>
                Aide & Manuel d'utilisation
            </h2>
            <p class="lead text-muted">
                Bienvenue dans le centre d'aide du Système de Gestion UJEPH (SG-UJEPH)
            </p>
            <p class="text-muted">
                Cette section vous guide dans l'utilisation du système selon votre rôle et vos permissions.
                Pour toute assistance supplémentaire, contactez le support technique.
            </p>
        </div>
    </div>

    <div class="row">
        <!-- Section générale pour tous les utilisateurs -->
        <div class="col-lg-8">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-info-circle"></i>
                        Présentation générale du système
                    </h5>
                </div>
                <div class="card-body">
                    <h6 class="text-primary">Fonctionnalités de base</h6>
                    <ul class="mb-3">
                        <li><strong>Connexion sécurisée :</strong> Authentification par identifiant et mot de passe</li>
                        <li><strong>Accès contrôlé :</strong> Interface adaptée à votre rôle (Admin, Professeur, Étudiant)</li>
                        <li><strong>Sécurité :</strong> Déconnexion automatique après 30 minutes d'inactivité</li>
                        <li><strong>Navigation :</strong> Menu supérieur et/ou menu déroulant selon votre profil</li>
                        <li><strong>Permissions :</strong> Les administrateurs ont différents niveaux d'accès (voir ci-dessous)</li>
                    </ul>
                    
                    <h6 class="text-primary">Premiers pas</h6>
                    <ol>
                        <li>Connectez-vous avec vos identifiants fournis</li>
                        <li>Consultez le tableau de bord pour un aperçu rapide</li>
                        <li>Utilisez le menu pour accéder aux différentes sections</li>
                        <li>Si vous êtes administrateur, vérifiez vos permissions dans votre profil</li>
                        <li hidden>N'hésitez pas à utiliser le bouton "Aide" contextuel <i class="bi bi-question-circle"></i> dans chaque module</li>
                    </ol>
                </div>
            </div>

            <!-- Sections spécifiques selon le rôle -->
            {% if user.role == 'admin' %}
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-shield-check"></i>
                        Guide Administrateur - Niveaux d'accès
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Section Super Administrateur -->
                    <div class="alert alert-danger mb-4">
                        <h6 class="alert-heading">
                            <i class="bi bi-shield-fill-check"></i>
                            Super Administrateur
                            <span class="badge bg-dark ms-2">ACCÈS COMPLET</span>
                        </h6>
                        <p class="mb-2">Toutes les permissions système activées</p>
                        <div class="row small">
                            <div class="col-md-6">
                                <strong>Utilisateurs :</strong>
                                <ul class="mb-0">
                                    <li>Création/modification des comptes utilisateurs</li>
                                    <li>Attribution des rôles et permissions</li>
                                    <li>Activation et desactivation des comptes</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <strong>Académique :</strong>
                                <ul class="mb-0">
                                    <li>Gestion des facultés et des cours</li>
                                    <li>Gestion des semestres et années</li>
                                    <li>Validation et publication des notes</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Section Administrateur Académique -->
                    <div class="alert alert-warning mb-4">
                        <h6 class="alert-heading">
                            <i class="bi bi-book"></i>
                            Administrateur Académique
                            <span class="badge bg-warning text-dark ms-2">PERMISSIONS MIXTES</span>
                        </h6>
                        <p class="mb-2">Focus sur la gestion académique (selon configuration)</p>
                        <div class="row small">
                            <div class="col-md-6">
                                <strong>Peut inclure :</strong>
                                <ul class="mb-0">
                                    <li>✅ Gestion des cours</li>
                                    <li>✅ Gestion des facultés</li>
                                    <li>✅ Validation des notes</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <strong>Ne peut PAS inclure :</strong>
                                <ul class="mb-0">
                                    <li>❌ Gestion des utilisateurs (sauf si configuré)</li>
                                    <li>❌ Création de comptes admin</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Section Gestionnaire Utilisateurs -->
                    <div class="alert alert-info mb-4">
                        <h6 class="alert-heading">
                            <i class="bi bi-people"></i>
                            Gestionnaire Utilisateurs
                            <span class="badge bg-info ms-2">LIMITÉ</span>
                        </h6>
                        <p class="mb-2">Gestion des comptes uniquement (selon configuration)</p>
                        <div class="row small">
                            <div class="col-md-6">
                                <strong>Peut inclure :</strong>
                                <ul class="mb-0">
                                    <li>✅ Création et gestion des comptes étudiants/profs</li>
                                    <li>✅ Gestion des administrateurs</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <strong>Ne peut PAS inclure :</strong>
                                <ul class="mb-0">
                                    <li>❌ Gestion académique (cours, notes)</li>
                                    <li>❌ Validation des notes</li>
                                    <li>❌ Gestion des facultés</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Tableau récapitulatif -->
                    <h6 class="mt-4 mb-3">Tableau récapitulatif des permissions</h6>
                    <div class="table-responsive">
                        <table class="table table-sm table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Permission</th>
                                    <th class="text-center">Super Admin</th>
                                    <th class="text-center">Admin Académique</th>
                                    <th class="text-center">Gestionnaire Utilisateurs</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Gérer les utilisateurs</td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-muted"><i class="bi bi-dash-lg"></i></td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                </tr>
                                <tr>
                                    <td>Gérer les cours</td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-muted"><i class="bi bi-dash-lg"></i></td>
                                </tr>
                                <tr>
                                    <td>Valider les notes</td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-muted"><i class="bi bi-dash-lg"></i></td>
                                </tr>
                                <tr>
                                    <td>Gérer les facultés</td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-muted"><i class="bi bi-dash-lg"></i></td>
                                </tr>
                                <tr>
                                    <td>Accès au journal d'audit</td>
                                    <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                    <td class="text-center text-warning"><i class="bi bi-eye"></i> (lecture)</td>
                                    <td class="text-center text-muted"><i class="bi bi-dash-lg"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-light border mt-4">
                        <small>
                            <i class="bi bi-info-circle me-1"></i>
                            <strong>Note :</strong> Les permissions des "Administrateurs Académiques" et "Gestionnaires Utilisateurs" 
                            peuvent être configurées individuellement lors de leur création. Certains peuvent avoir des combinaisons
                            spécifiques selon les besoins.
                        </small>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if user.role == 'prof' %}
            <div class="card shadow-sm mb-4 border-success">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-person-badge"></i>
                        Guide Professeur
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Mes cours</h6>
                    <ul class="mb-3">
                        <li>Consultez la liste des cours qui vous sont assignés</li>
                        <li>Accédez à la liste des étudiants par cours</li>
                        <li>Cliquez sur le bouton saisir notes pour la saisie de notes</li>
                    </ul>
                    
                    <h6>Saisie des notes</h6>
                    <ul class="mb-3">
                        <li>Saisissez les notes pour chaque évaluation</li>
                        <li>Enregistrez les notes comme si si pas encore prêt à être soumis</li>
                        <li>Soumettez les notes pour validation par l'administration</li>
                        <li>Vérifiez les notes avant validation définitive</li>
                        <li>Suivez l'état de validation des notes de vos cours</li>
                    </ul>
                    
                    <h6>Communication avec l'administration</h6>
                    <ul>
                        <li>Contactez les administrateurs pour toute question</li>
                        <li>Consultez les annonces académiques</li>
                        <li>Vérifiez les dates limites de soumission des notes</li>
                    </ul>
                </div>
            </div>
            {% endif %}

            {% if user.role == 'student' %}
            <div class="card shadow-sm mb-4 border-primary">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-person-circle"></i>
                        Guide Étudiant
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Mes informations</h6>
                    <ul class="mb-3">
                        <li>Consultez votre profil et informations personnelles</li>
                        <li>Vérifiez votre programme académique</li>
                        <li hidden>Consultez votre emploi du temps</li>
                        <li>Mettez à jour vos coordonnées si nécessaire</li>
                    </ul>
                    
                    <h6>Résultats académiques</h6>
                    <ul class="mb-3">
                        <li>Consultez vos notes par semestre (S1/S2)</li>
                        <li>Visualisez votre moyenne générale calculée automatiquement</li>
                        <li>Vérifiez votre statut académique (actif, redoublant, diplômé)</li>
                        <li hidden>Téléchargez vos relevés de notes (une fois publiés par l'admin)</li>
                    </ul>
                    
                    <h6>Communication</h6>
                    <ul>
                        <li>Accédez aux annonces académiques importantes</li>
                        <li hidden>Consultez les informations sur vos professeurs</li>
                        <li hidden>Recevez les notifications du système</li>
                        <li>Contactez l'administration pour tout problème</li>
                    </ul>
                </div>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar avec informations supplémentaires -->
        <div class="col-lg-4">
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-shield-exclamation"></i>
                        Sécurité & Bonnes pratiques
                    </h6>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-key"></i>
                        <strong>Protégez vos identifiants</strong>
                        <p class="small mb-0">Ne partagez jamais votre mot de passe avec qui que ce soit.</p>
                    </div>
                    
                    <ul class="small">
                        <li><strong>Administrateurs :</strong> Ne partagez pas votre session avec d'autres</li>
                        <li>Déconnectez-vous après chaque session</li>
                        <li>Évitez d'utiliser le système sur des ordinateurs publics</li>
                        <li>Changez votre mot de passe régulièrement</li>
                        <li>Vérifiez toujours l'URL du site (https://)</li>
                        <li>Signalez toute activité suspecte immédiatement</li>
                        <li><strong>Professeurs :</strong> Soumettez les notes avant les délais imposés</li>
                        <li><strong>Étudiants :</strong> Vérifiez régulièrement vos notes et annonces</li>
                    </ul>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-clock-history"></i>
                        Système de suivi
                    </h6>
                </div>
                <div class="card-body">
                    <p class="small mb-2">
                        <strong>Toutes les actions importantes sont tracées :</strong>
                    </p>
                    <ul class="small text-muted">
                        <li>Connexions et déconnexions des utilisateurs</li>
                        <li>Créations/modifications/suppressions de comptes</li>
                        <li>Saisie et validation des notes</li>
                        <li>Gestion des cours et facultés</li>
                        <li>Tentatives de connexion échouées</li>
                    </ul>
                    <p class="small text-muted mt-2">
                        <i class="bi bi-info-circle"></i>
                        Le journal d'audit est accessible aux administrateurs autorisés.
                    </p>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="bi bi-telephone"></i>
                        Support technique
                    </h6>
                </div>
                <div class="card-body">
                    <p class="small">
                        <strong>En cas de problème :</strong>
                    </p>
                    <ul class="small">
                        <li><i class="bi bi-envelope"></i> Email : info@ujeph.edu.ht</li>
                        <li><i class="bi bi-telephone"></i> Téléphones : +509 3864 3657 / +509 4207 7766</li>
                        <li><i class="bi bi-clock"></i> Horaires : 8h-17h, Lundi-Vendredi</li>
                    </ul>
                    <div class="mt-3">
                        <strong class="small">Urgences :</strong>
                        <p class="small text-muted mb-1">
                            <i class="bi bi-exclamation-triangle text-warning"></i>
                            Problèmes de connexion → Contactez votre administrateur local
                        </p>
                        <p class="small text-muted mb-0">
                            <i class="bi bi-exclamation-triangle text-warning"></i>
                            Erreurs dans les notes → Contactez votre professeur ou l'administration
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FAQ rapide -->
    <div class="mt-4 pt-3 border-top">
        <h5><i class="bi bi-chat-question"></i> Questions fréquentes</h5>
        <div class="accordion" id="faqAccordion">
            <div class="accordion-item">
                <h6 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                        J'ai oublié mon mot de passe
                    </button>
                </h6>
                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body small">
                        Contactez un administrateur de votre faculté ou le support technique pour une réinitialisation.
                        <strong>Administrateurs :</strong> Utilisez la fonction de réinitialisation depuis le panneau d'administration.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h6 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                        Mes notes ne s'affichent pas
                    </button>
                </h6>
                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body small">
                        <strong>Étudiants :</strong> Les notes ne sont visibles qu'après validation par l'administration. 
                        Vérifiez aussi que vous consultez le bon semestre (S1/S2).
                        <strong>Professeurs :</strong> Vos notes doivent être soumises et validées pour être visibles.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h6 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                        Je ne vois pas certaines fonctionnalités dans mon menu
                    </button>
                </h6>
                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                    <div class="accordion-body small">
                        <strong>Administrateurs :</strong> Votre menu est adapté à votre niveau d'accès. 
                        Si vous pensez avoir besoin d'accéder à une fonctionnalité manquante, 
                        contactez un Super Administrateur pour ajuster vos permissions.
                        <strong>Autres utilisateurs :</strong> Votre menu correspond à votre rôle (Professeur ou Étudiant).
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}